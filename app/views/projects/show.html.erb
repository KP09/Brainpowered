<div class="page-wrapper">
  <div class="container">
    <div class="company-show-information margin-top">
      <div class="container">
        <div class="row">
          <div class="col-lg-12 col-xs-12">
            <div class="left-project-info">
              <div class="flex-box">
                <div class="company-logo">
                  <a href="#" data-toggle="popover" data-placement="bottom" title="<%= @project.user.company_name %>" data-content="<%= @project.user.description[0..100] %>">
                    <%= image_tag ('company.png'), class: 'avatar-large' %>
                  </a>
                </div>
                <div class="company-name-title">
                  <p><%= @project.user.company_name %></p>
                  <h2><%= @project.title %></h2>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-xs-12 flex-box">

          </div>
        </div>
        <div class="row">
          <div class="col-lg-9">
            <div class="shadow-box margin-top">
              <div class="box-title">
                <p>Brief:</p>
              </div>
              <div class="view-count">
                <p><i class="fa fa-eye"></i> <%= @project.impressionist_count(:filter=>:ip_address) %> times</p>
              </div>
              <div class="brief-content">
                <p><%= @project.brief %></p>
              </div>
            </div>
            <!-- logic for different project status -->
            <div class="shadow-box margin-top">
              <!-- If the project is still active show participants render -->
              <% if @project.days_left > 0 %>
                <div class="box-title">
                  <p>Participants:</p>
                </div>
                <div class="render">
                  <%= render "participants", project: @project %>
                </div>
              <!-- If the project is no longer active show contributions render -->
              <% else %>
                <div class="box-title">
                  <p>Contributions:</p>
                </div>
                <div class="render">
                  <%= render "contributers", project: @project %>
                </div>
              <% end %>
            </div>
            <div class="similar margin-top">
              <p>Similar Projects</p>
                <div class="row">
                  <% @similar_projects.each do |project| %>
                    <div class="col-md-4 padding-none">
                      <%= render "card", project: @project %>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>
          <div class="col-lg-3 margin-top">
            <div class="flex-box">
              <div class="counter">
                <div class="counter-title">
                    <p><i class="fa fa-calendar"></i> Days Left</p>
                </div>
                <div class="counter-nums">
                  <p><%= @project.days_left %></p>
                </div>
              </div>
              <div class="counter no-margin">
                <div class="counter-title">
                    <p><i class="fa fa-users" aria-hidden="true"></i> Spaces</p>
                </div>
                <div class="counter-nums">
                  <p><%= @project.spaces_left %></p>
                </div>
                </div>
            </div>
          <% if @project.days_left > 0 && @current_user.participated_to?(@project) %>
            <div class="contribution">
              <div class="contributions-title">
                <div>
                  <h2>Contributions</h2>
                </div>
              </div>
                <%= render "make-contribution", project: @project %>
              </div>
              <p class="margin-top" style="font-size: 15px;">Not enjoying this project? Got too much on to complete the task? Click leave project to open up your space!</p>
              <%= link_to "Leave Project", project_participation_path(@project), class: "btn btn-default", method: :DELETE, style: "width:100%" %>
            <% elsif @project.days_left > 0 && !@current_user.participated_to?(@project) %>
              <p>Like the look of this project? Get started today by clicking join below!</p>
              <%= link_to "Join Project", project_participations_path(@project), class: "btn btn-primary", method: :post, style: "width:100%" %>
            <% elsif @project.days_left < 0 %>
              <p>It looks like the project you are trying to join has closed. Search for similar projects by clicking below!</p>
              <%= link_to "Search Similar Projects", search_path, class: "btn btn-primary", style: "width:100%" %>
            <% end %>
              <br>
          </div>
        </div>
      </div>
      <div class="col-lg-3 margin-top">
        <h2>Join Project</h2>
        <p>Like the look of this project? Get started today by clicking join below!</p>
        <%= link_to "Join Project", project_participations_path(@project), class: "btn btn-primary", method: :post, style: "width:100%" %>
        <br>
      </div>
    </div>
  </div>
</div>
